"use strict";(self["webpackChunkquant_ux"]=self["webpackChunkquant_ux"]||[]).push([[982],{27949:function(t,e,s){s.d(e,{Z:function(){return m}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{class:[{MatcHelpIcon:!t.hasToolbar},{"MatcToolbarItem MatcNotification":t.hasToolbar}],on:{click:t.open}},[s("div",{attrs:{type:"button"}},[s("QIcon",{attrs:{icon:"Help"}}),t.newNotifications?s("span",{staticClass:"MatcNotificationBubble"},[t._v(t._s(t.newNotifications))]):t._e()],1)])},i=[],n=s(51804),l=s(55887),o=s(98654),r=s(93921),h=s(27437),c=s(63403),d={name:"HelpButton",mixins:[r.Z],props:["topic","subtopic","hasNotifications","hasToolbar"],data:function(){return{newNotifications:0}},components:{QIcon:c.Z},methods:{show(t,e){let s=new n.Z;var a=new l.Z,i=a.div("MatcDialog MatcHelpDialog MatcPadding").build();s.popup(i,this.$el),setTimeout((()=>{let s=this.$new(o.Z,{hasNotifications:!1});s.placeAt(i),s.setTopic(t),s.setSupTopic(e,!0)}),300)},open(){this.hasToolbar&&(h.Z.getUserService().setLastNotication(),this.newNotifications=0);let t=new n.Z;var e=new l.Z,s=e.div("MatcDialog MatcHelpDialog MatcPadding").build();t.popup(s,this.$el),setTimeout((()=>{let t=this.$new(o.Z,{hasNotifications:this.hasNotifications});t.placeAt(s),this.topic&&(t.setTopic(this.topic),t.setSupTopic(this.subtopic,!0))}),300)},async initNotification(){let t=await h.Z.getUserService().getLastNotication();if(t){let a=t.lastNotification,i=0,n=await h.Z.getUserService().getNotications();for(var e=0;e<n.length;e++){var s=n[e];s.lastUpdate>a&&i++}this.newNotifications=i}}},mounted(){this.hasNotifications&&this.initNotification()}},u=d,p=s(43736),b=(0,p.Z)(u,a,i,!1,null,null,null),m=b.exports},27566:function(t,e,s){s.d(e,{Z:function(){return m}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcButton MatcDropDownButton MatcDropDownSelect"},[s("div",{ref:"button",staticClass:"MatcDropDownButtonCntr",attrs:{type:"button"}},[t.icon?s("QIcon",{attrs:{icon:t.icon}}):t._e(),s("label",{staticClass:"MatcDropDownLabel",attrs:{"data-dojo-attach-point":"label"}}),s("span",{staticClass:"caret"})],1),t._m(0)])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcDropDownPopUp ",attrs:{role:"menu","data-dojo-attach-point":"popup"}},[s("ul",{attrs:{role:"menu","data-dojo-attach-point":"ul"}})])}],n=s(91241),l=s(14680),o=s(42477),r=s(93134),h=s(24615),c=s(4623),d={name:"DropDownSelect",mixins:[n.Z],data:function(){return{icon:"",openCSS:"MatcDropDownButtonOpen",iconCSS:"MatcDropDownIcon",labelCSS:"MatcDropDownLabel",selectedCSS:"MatcDropDownButtonSelected",liCSS:"MatcDropDownMenuItem",updateLabel:!1,selected:{}}},methods:{renderOptions(t){for(let e=0;e<t.length;e++){const s=t[e],a=document.createElement("li");if(r.Z.add(a,this.liCSS),s.check){const t=document.createElement("span");r.Z.add(t,"MatcDropDownSelectCheck"),a.appendChild(t);const e=this.$new(l.Z);e.setValue(s.selected),e.setLabel(s.label),e.placeAt(t),e.on("change",o.Z.hitch(this,"onSelect",s)),this._lis[s.value]=a,this.selected[s.value]=s.selected}else if(s.label||s.icon){if(this.hasObjects=!0,s.icon){const t=document.createElement("span");r.Z.add(t,this.iconCSS),r.Z.add(t,s.icon),a.appendChild(t)}if(s.label){const t=document.createElement("label");r.Z.add(t,this.labelCSS),t.innerHTML=s.label,a.appendChild(t)}this.own((0,h.Z)(a,c.Z.press,o.Z.hitch(this,"onClick",s))),this._lis[s.value]=a}s.css&&r.Z.add(a,s.css),this.ul.appendChild(a)}},onSelect(t,e){t.callback?t.callback(e):(this.selected[t.value]=e,this.$emit("select",this.selected))},onClick(t,e){t.event&&this.$emit(t.event,e)}},watch:{}},u=d,p=s(43736),b=(0,p.Z)(u,a,i,!1,null,null,null),m=b.exports},52309:function(t,e,s){s.d(e,{Z:function(){return G}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcDistributionSection"},[s("div",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("h3",{staticClass:"title level-item"},[s("span",[t._v(t._s(t.$t("analytics.distribution.title")))]),s("HelpButton",{attrs:{topic:"analytics.dist",hasNotifications:!1}})],1)]),s("div",{staticClass:"level-right level-options"},[t.hasConfig?s("CheckBox",{attrs:{value:!1,label:"zScore"},on:{change:t.onChangeNorm}}):t._e(),t.hasConfig?s("DropDownButton",{attrs:{value:t.clusterAlgo,options:t.clusterAlgoOptions},on:{change:t.onChangeAlgo}}):t._e(),t.hasConfig?s("DropDownSelect",{ref:"dropDown",attrs:{options:t.clusterOptions,l:t.$t("analytics.distribution.cluster-vars")},on:{select:t.onChangeCluster,algo:t.onChangeAlgo}}):t._e()],1)]),s("div",{staticClass:"MatcSurveySectionTableCntr"},[t.events&&t.events.length>0?["Scatter"===t.viewMode?s("ScatterPlot",{attrs:{yAxis:t.yAxis,xAxis:t.xAxis,app:t.app,pub:t.pub,clusterVars:t.clusterVars,clusterAlgo:t.clusterAlgo,clusterNorm:t.clusterNorm,events:t.events,annotation:t.annotation,test:t.test}}):t._e()]:s("span",{staticClass:"MatcHint"},[t._v(" "+t._s(t.$t("analytics.distribution.no-data"))+" ")])],2)])},i=[],n=s(14285),l=s(99925),o=s(14680),r=s(27566),h=s(27949),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"MatcScatterPlot MatcScatterPlot"+t.mode},[s("div",{staticClass:"MatcScatterPlotfActionCntr",attrs:{"data-dojo-attach-point":"actionCntr"}}),s("div",{staticClass:"MatcScatterPlotCntr",attrs:{"data-dojo-attach-point":"cntr"},on:{click:t.onBackgroundClick}},[s("span",{staticClass:"MatxAxisXLine MatcScatterPlotfScatternVisible MatcScatterPlotDurationHidden",attrs:{"data-dojo-attach-point":"xLine"}}),s("span",{staticClass:"MatxAxisYLine MatcScatterPlotfScatternVisible MatcScatterPlotDurationHidden",attrs:{"data-dojo-attach-point":"yLine"}}),s("div",{staticClass:"MatcScatterPlotCanvas",attrs:{"data-dojo-attach-point":"canvas"}}),s("span",{staticClass:"MatxAxisLabel xMaxLabel",attrs:{"data-dojo-attach-point":"xMaxLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcScatterPlotDropOffHidden yMaxLabel",attrs:{"data-dojo-attach-point":"yMaxLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcScatterPlotfScatternVisible MatcScatterPlotDurationHidden xMiddleLabel",attrs:{"data-dojo-attach-point":"xMiddleLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcScatterPlotfScatternVisible MatcScatterPlotDurationHidden yMiddleLabel",attrs:{"data-dojo-attach-point":"yMiddleLabel"}}),s("span",{staticClass:"MatxAxisLabel minLabel",attrs:{"data-dojo-attach-point":"minLabel"}},[t._v("0")]),s("span",{staticClass:"MatxAxisLabel xLabel ",attrs:{"data-dojo-attach-point":"xLabel"}},[t._v("X")]),s("span",{staticClass:"MatxAxisLabel yLabel MatcScatterPlotDropOffHidden",attrs:{"data-dojo-attach-point":"yLabel"}},[t._v("Y")]),s("span",{staticClass:"MatxAxisLabel yLabelEast MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"yLabelEast"}},[t._v("Y")]),s("span",{staticClass:"MatxAxisLabel yMinLabelEast MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"yMinLabelEast"}},[t._v("0")]),s("span",{staticClass:"MatxAxisLabel yMaxLabelEast MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"yMaxLabelEast"}},[t._v("100")]),s("span",{staticClass:"MatxAxisLabel yMinLabel",attrs:{"data-dojo-attach-point":"yMinLabel"}}),s("span",{staticClass:"MatxAxisLabel bottom25Label MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"bottom25Label"}}),s("span",{staticClass:"MatxAxisLabel bottom75Label MatcScatterPlotfDetailsVisible",attrs:{"data-dojo-attach-point":"bottom75Label"}}),s("span",{staticClass:"MatxAxisLabel MatxAxisLabelCntr",attrs:{"data-dojo-attach-point":"xAxisLabelCntr"}}),s("div",{staticClass:"MatcScatterPlotfTaskCntr",attrs:{"data-dojo-attach-point":"taskCntr"}},[s("div",{class:{MatcScatterPlotfTaskSelected:t.hasOutliers},on:{click:function(e){return t.toggleOutlier()}}},[s("span",{style:t.getOutlierStyle()}),s("label",[t._v(" "+t._s(t.getNLS("analytics.distribution.outlier")))])])]),t.hoverDetails?s("ScatterPlotDetails",{attrs:{value:t.hoverDetails}}):t._e()],1),s("div",{staticClass:"MatcScatterPlotHintBar",attrs:{"data-dojo-attach-point":"hintCntr"}})])},d=[],u=s(24615),p=s(42477),b=s(93134),m=s(41474),f=s(55887),v=s(50597),M=s(21200),g=s(77907),L=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"MatcScatterPlotDetails "+t.value.cls,style:"bottom: "+t.value.y+"%; left:"+t.value.x+"%"},[s("span",{staticClass:"MatcScatterPlotDetailsArrow"}),s("div",{staticClass:"MatcScatterPlotDetailsContainer"},[s("table",[s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.duration"))+": ")]),s("td",[t._v(" "+t._s(Math.round(t.value.s.duration/1e3))+" s ")])]),s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.interactions"))+": ")]),s("td",[t._v(" "+t._s(t.value.s.interactions)+" ")])]),s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.screens"))+" : ")]),s("td",[t._v(" "+t._s(t.value.s.screenUnique)+" / "+t._s(t.value.s.screenLoads)+" ")])]),s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.weirdness"))+" : ")]),s("td",[t._v(" "+t._s(Math.round(100*t.value.s.weirdness))+" ")])]),s("tr",[s("td",[t._v(" "+t._s(t.getNLS("analytics.distribution.details.tasks"))+": ")]),s("td",[s("div",{staticClass:"MatcScatterPlotDetailsTaskCntr"},t._l(t.value.tasks,(function(e){return s("span",{key:e,staticClass:"MatcScatterPlotDetailsTask"},[t._v(" "+t._s(e)+" ")])})),0)])])])])])},k=[],S=s(93921),T={name:"ScatterPlotDetails",mixins:[S.Z],props:["value"],data:function(){return{}},components:{},methods:{},watch:{},mounted(){}},x=T,C=s(43736),_=(0,C.Z)(x,L,k,!1,null,null,null),y=_.exports,w=s(388),D=s(77161),P=s(19519),Z={name:"ScatterPlot",mixins:[m.Z,v.Z],props:["test","app","events","annotation","pub","mode","yAxis","xAxis","clusterVars","clusterAlgo","clusterNorm"],data:function(){return{tasks:[],selectedTasks:{},hasOutliers:!0,paddingFactor:1.1,dialog:!1,includeDropOff:!1,defaultColor:"#365fff",outlierColor:"#f83a3a",clusters:[],colors:["#9933cc","#669900","#ff8a00","#cc0000","#000000","#8ad5f0","#d6adeb","#c5e26d"],bins:3,hoverDetails:null}},components:{ScatterPlotDetails:y},methods:{getOutlierStyle(){return this.hasOutliers?`background:${this.outlierColor}; border:none`:""},getTaskStyle(t){return this.selectedTasks[t.id]?`background:${t.color}; border:none`:""},postCreate(){this.init(),this._scatterPoints={}},init(){this.db=new f.Z,this._scatterPoints={}},setValue(t,e,s,a){this.logger.log(-1,"setValue","enter"),D.Z.start("ScatterPlot.setValue()"),this.annotations=a,this.model=e;try{const e=this.filterEvents(s,a);this.df=this.getActionEvents(new g.Z(e)),this.df.sortBy("time"),this.tasks=p.Z.clone(t.tasks).filter((t=>t.flow.length>=2)),this.sessionDetails=this.analytics.getSessionDetails(this.df,this.tasks),this.sessionDetails=w.fZ(this.sessionDetails,this.df);let i=this.analytics.convertSessionDetails(this.sessionDetails);i.length<200?this.clusters=w.ki(i,this.clusterVars,this.clusterNorm,this.clusterAlgo):(this.logger.error("setValue","Too many events"),this.hasOutliers=!1),this.render()}catch(i){this.logger.error("setValue","Error"),this.logger.sendError(i)}D.Z.end("ScatterPlot.setValue()")},clickTask(t){this.selectTask(t),this.render(),this.$forceUpdate()},toggleOutlier(){this.hasOutliers=!this.hasOutliers,this.render(),this.$forceUpdate()},selectTask(t){this.selectedTasks[t?.id]=!this.selectedTasks[t?.id];for(let e in this.selectedTasks)e!==t?.id&&(this.selectedTasks[e]=!1)},render(){this.logger.log(-1,"render","enter > "),this.cleanUpTempListener(),this.onBackgroundClick(),this.render_Scatter()},onBackgroundClick(){this.setHint(this.db.span("",this.getNLS("analytics.distribution.hint")).build()),this.unSelectPoint()},render_Scatter(){this.logger.log(1,"render_Scatter","enter",this.mode),delete this._selectedScatterPoint,this.xLabel.innerHTML=this.getNLS("analytics.distribution.details."+this.xAxis),this.yLabel.innerHTML=this.getNLS("analytics.distribution.details."+this.yAxis),this.minLabel.innerHTML="0 s",this.yMinLabel.innerHTML="0",this.render_Scatter_Points(this.xAxis,this.yAxis)},render_Scatter_Points(t,e){this.logger.log(1,"render_Scatter_Points","enter > "+t+" X "+e);const s=this.sessionDetails,a=Math.max(1,Math.ceil(s.max(t)*this.paddingFactor)),i=Math.max(1,Math.ceil(s.max(e)*this.paddingFactor)),n=s.mean(t),l=s.mean(e);this.xMaxLabel.innerHTML=Math.ceil(a/1e3)+" s",this.yMaxLabel.innerHTML=Math.ceil(i);const o=s.data;for(let r=0;r<o.length;r++){const s=o[r],n=s[t],l=s[e];this.renderScatterPoint(r,s,n,l,a,i)}this.maxYAxis=i,this.maxXAxis=a,this.meanYAxis=l,this.meanXAxis=n,this.unSelectPoint()},renderScatterPoint(t,e,s,a,i,n){const l=e.session,o=Math.min(10*t,300);if(!this._scatterPoints[l]){const t=this.db.span("MatxScatterPoint").build(this.canvas);t.style.bottom="-5%",t.style.left=s/i*100+"%",this._scatterPoints[l]=t}const r=this.getPointColor(e,t),h=this._scatterPoints[l];h.style.background=r,this.tempOwn((0,u.Z)(h,"click",p.Z.hitch(this,"selectPoint",h,e,s,a,t))),this.tempOwn((0,u.Z)(h,"mouseover",p.Z.hitch(this,"hoverPoint",h,e,s,a,t))),this.tempOwn((0,u.Z)(h,"mouseout",p.Z.hitch(this,"leavePoint"))),setTimeout(p.Z.hitch(this,"animateScatterPoint",h,s,a,i,n),o)},animateScatterPoint(t,e,s,a,i){t.style.bottom=s/i*100+"%",t.style.left=e/a*100+"%"},unSelectPoint(){setTimeout(p.Z.hitch(this,"setMiddle",this.meanYAxis,this.maxYAxis,this.meanXAxis,this.maxXAxis),200)},getPointColor(t,e){if(-1===this.clusters[e]&&this.hasOutliers)return this.outlierColor;for(let s in this.selectedTasks)if(this.selectedTasks[s]&&t[s]&&t[s].success)return this.taskColors[s];return this.defaultColor},hoverPoint(t,e,s,a){let i=100*s/this.maxXAxis,n=100*a/this.maxYAxis,l="";l+=i>50?"left ":"right ",l+=n>50?"bottom ":"top ";const o=[];this.tasks.forEach((t=>{1===e[t.id]?.success&&o.push(t.name)})),this.hoverDetails={x:i,y:n,cls:l,s:e,tasks:o}},leavePoint(){this.hoverDetails=null},selectPoint(t,e,s,a,i,n){this.stopEvent(n),this.setXMiddle(s,this.maxXAxis),this.setYMiddle(a,this.maxYAxis),b.Z.add(this.cntr,"MatcScatterPlotCntrHover"),this._selectedScatterPoint=t,this.showSessionReplayHint(e.session)},showSessionReplayHint(t){if(this.model){let e="#/apps/"+this.model.id+"/replay/"+t+".html";"public"==this.mode&&(e="#/examples/"+this.model.id+"/replay/"+t+".html");const s=this.db.span("").build();this.db.span("",this.getNLS("analytics.distribution.play")).build(s);const a=this.db.a("",this.getNLS("analytics.distribution.here")).build(s);a.href=e,a.target="_matcSessionReplay"+t,this.setHint(s)}},setHint(t){this.hintCntr.innerHTML="",t&&(this.hintCntr.appendChild((0,P.Xl)("PlayVideo")),this.hintCntr.appendChild(t))},clearPoint(){b.Z.remove(this.cntr,"MatcScatterPlotCntrHover")},setMiddle(t,e,s,a){this.setXMiddle(s,a),this.setYMiddle(t,e),b.Z.remove(this.cntr,"MatcScatterPlotCntrHover")},setYMiddle(t,e){this.yMiddleLabel.innerHTML=Math.ceil(t),this.yMiddleLabel.style.bottom=t/e*100+"%",this.yLine.style.bottom=t/e*100+"%"},setXMiddle(t,e){this.xMiddleLabel.innerHTML=Math.ceil(t/1e3)+" s",this.xMiddleLabel.style.left=t/e*100+"%",this.xLine.style.left=t/e*100+"%"}},watch:{mode(t){this.mode=t,this.render()},yAxis(t){this.yAxis=t,this.render()},xAxis(t){this.xAxis=t,this.render()},clusterVars(t){this.clusterVars=t,this.setValue(this.test,this.app,this.events,this.annotation)},clusterAlgo(t){this.clusterAlgo=t,this.setValue(this.test,this.app,this.events,this.annotation)},clusterNorm(t){this.clusterNorm=t,this.setValue(this.test,this.app,this.events,this.annotation)}},mounted(){this.analytics=new M.Z,this.logger=new n.Z("ScatterPlot"),this.db=new f.Z,this.setValue(this.test,this.app,this.events,this.annotation)}},H=Z,A=(0,C.Z)(H,c,d,!1,null,null,null),N=A.exports,E={name:"DistributionSection",mixins:[],props:["test","app","events","annotation","pub"],data:function(){return{xAxis:"duration",yAxis:"interactions",hasOutlier:!1,hasConfig:!1,isLoaded:!1,scatterMode:"duration,interactions",viewMode:"Scatter",viewOptions:[{value:"Scatter",label:this.$t("analytics.distribution.viewScatter"),event:"scatter"},{value:"Details",label:this.$t("analytics.distribution.viewDetails"),event:"outlier"},{value:"Outlier",label:this.$t("analytics.distribution.viewOutlier"),event:"outlier"}],selection:[],cols:[{key:"interactions",label:"Interactions"},{key:"duration",label:"Duration"},{key:"screens",label:"Test Coverage"},{key:"tasks",label:"Tasks"},{key:"outlierRaw",label:"Outlier Raw"},{key:"outlierUmap",label:"Outlier Umap"}],clusterAlgoOptions:[{value:"optics",label:"Optics"},{value:"dbscan",label:"DBScan"},{value:"lof",label:" LOF"}],clusterOptions:[{value:"duration",label:this.$t("analytics.distribution.details.duration"),check:!0,selected:!0},{value:"interactions",label:this.$t("analytics.distribution.details.interactions"),check:!0,selected:!0},{value:"screenLoads",label:this.$t("analytics.distribution.details.screenLoads"),check:!0,selected:!0},{value:"screenRatio",label:this.$t("analytics.distribution.details.screenRatio"),check:!0,selected:!1},{value:"tasks",label:this.$t("analytics.distribution.details.tasks"),check:!0,selected:!0},{value:"weirdness",label:this.$t("analytics.distribution.details.weirdness"),check:!0,selected:!1}],clusterAlgo:"optics",clusterNorm:"minmax",clusterVars:["interactions","duration","screenLoads","tasks"]}},components:{HelpButton:h.Z,DropDownSelect:r.Z,DropDownButton:l.Z,ScatterPlot:N,CheckBox:o.Z},computed:{},methods:{onChangeNorm(t){this.clusterNorm=t?"zScore":"minmax"},onChangeAlgo(t){this.clusterAlgo=t},onChangeCluster(t){let e=[];Object.keys(t).forEach((s=>{const a=t[s];a&&e.push(s)})),this.clusterVars=e},setScatterMode(t){if(t){let e=t.split(",");this.xAxis=e[0],this.yAxis=e[1]}this.scatterMode=t},setViewMode(t){this.viewMode=t,this.selection=[]},showSelection(t){this.selection=t}},mounted(){this.logger=new n.Z("DistributionSection"),this.isLoaded=!0}},B=E,V=(0,C.Z)(B,a,i,!1,null,null,null),G=V.exports},13929:function(t,e,s){s.d(e,{Z:function(){return v}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:"MatcDialog TaskCreateDialog "+t.model.type},[s("div",{staticClass:"TaskCreateDialogCntr"},[s("div",{staticClass:"FormCntr"},[s("div",{staticClass:"form-group"},[s("label",[t._v("Name")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.task.name,expression:"task.name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Name"},domProps:{value:t.task.name},on:{input:function(e){e.target.composing||t.$set(t.task,"name",e.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",[t._v("Description")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.task.description,expression:"task.description"}],staticClass:"form-control",attrs:{type:"text",placeholder:"An explaination for the users"},domProps:{value:t.task.description},on:{input:function(e){e.target.composing||t.$set(t.task,"description",e.target.value)}}})]),s("div",[s("label",[t._v("Expected Steps")]),s("p",{staticClass:"MatcHint mb-16"},[t._v("Click in the simulator to add steps. You can remove steps that are not needed by clicking on them.")]),s("div",{staticClass:"StepCntr form-group"},t._l(t.steps,(function(e,a){return s("div",{key:a,staticClass:"Step"},[a>0?s("span",{staticClass:"mdi mdi-arrow-right"}):t._e(),s("div",{staticClass:"StepDetails"},[t._v(" "+t._s(e.type)+" - "+t._s(e.label)+" "),s("div",{staticClass:"removePopup",on:{click:function(e){return t.removeEvent(a)}}},[s("span",{staticClass:"mdi"},[t._v("Remove")])])])])})),0),s("div",{staticClass:"form-group"},[s("CheckBox",{attrs:{label:"Strict matching. No events between are allowed.",value:t.task.strict},on:{change:t.setStrict}})],1),s("div",{staticClass:"form-group"},[s("CheckBox",{attrs:{label:"Record only screen views",value:t.recordOnlyScreenViews},on:{change:t.setRecordOnlyScreenView}})],1)])]),s("div",{ref:"simCntr",staticClass:"SimCntr"},[s("div",{ref:"wrapper",staticClass:"SimWrapper"}),t.abScreens&&t.abScreens.length>0?s("div",{staticClass:"ABSelector"},[s("p",{staticClass:"MatcHint"},[t._v(" Select the next screen to show ")]),t._l(t.abScreens,(function(e){return s("div",{key:e.id,staticClass:"MatcButton",on:{click:function(s){return t.selectABLine(e)}}},[t._v(" "+t._s(e.name)+" ")])}))],2):t._e()])]),s("div",{staticClass:"MatcButtonBar"},[s("a",{staticClass:"MatcButton MatcButtonPrimary",on:{click:t.onSave}},[t._v("Save")]),s("a",{staticClass:"MatcLinkButton",on:{click:t.onCancel}},[t._v("Cancel")])])])},i=[],n=s(93921),l=s(42477),o=s(24615),r=s(14285),h=s(14680),c=s(98825),d=s(50597),u=s(40626),p={name:"TaskCreateDialog",props:["model"],mixins:[d.Z,n.Z],data:function(){return{hash:"NoHashTaskCreate",recordOnlyScreenViews:!0,abScreens:null,ignoreFirstEvent:!1,task:{name:"",description:"",flow:[]},ignoredEvents:["SessionStart","ScreenAnimation","Animation","OverlayRemoveAnimation","OverlayShowAnimation","MouseOut","MouseOver","WidgetInit","ValidationOK"]}},components:{CheckBox:h.Z},computed:{steps(){return this.task.flow.map((t=>({screen:this.getScreenName(t.screen),widget:this.getWidgetName(t.widget),type:this.getEventLabelWithState(t),label:t.widget?this.getWidgetName(t.widget)+" @ "+this.getScreenName(t.screen):this.getScreenName(t.screen)})))}},methods:{getEventLabelWithState(t){return!t.state||"WidgetClick"!==t.type&&"WidgetChange"!==t.type?this.getEventLabel(t.type):this.getEventStateLabel(t.state)},setRecordOnlyScreenView(t){this.recordOnlyScreenViews=t},postCreate(){this.logger=new r.Z("TaskCreateDialog"),this.logger.log(-1,"postCreate","enter > "+this.appID+"> "+this.hash),setTimeout((()=>{this.createSimulator()}),500)},createSimulator(){const t=this.$refs.wrapper,e=this.resizeSimulatorContainer(this.model,this.$refs.simCntr,.7);t.style.width=e.w+"px",t.style.height=e.h+"px",this.simulator=this.$new(c.Z,{isDesktopTest:!0,mode:"recordFlow",logData:!1}),this.simulator.setHash(this.hash),this.tempOwn((0,o.Z)(this.simulator,"event",l.Z.hitch(this,"onEvent"))),this.simulator.placeAt(t),this.simulator.scrollListenTarget="parent",this.simulator.startup(),this.simulator.abSelector=(t,e)=>{this.showABDialog(t,e)},this.simulator.setModel(this.model)},async showABDialog(t,e){this.logger.log(-1,"showABDialog","enter > ",t),this.abCallback=e,this.abLines=t,this.abScreens=t.map((t=>{let e=t.to;return this.model.screens[e]?this.model.screens[e]:this.model.widgets[e]?this.model.widgets[e]:void 0}))},selectABLine(t){if(this.logger.log(-1,"selectABLine","enter > ",t),this.abLines&&this.abCallback){let e=this.abLines.find((e=>e.to===t.id));this.abCallback(e)}this.abLines=null,this.abScreens=null,this.abCallback=null},resizeSimulatorContainer(t,e){let s=u.Z.position(e);return s.h=600,"smartphone"==t.type?t.screenSize.h<t.screenSize.w?(this.logger.log(-1,"resizeSimulatorContainer","Wide screen"),s=this.getScaledSize(s,"width",t)):s=this.getScaledSize(s,"height",t):s=this.getScaledSize(s,"width",t),s},onEvent(t){if(this.logger.log(-1,"onEvent","enter > ignoreFirstEvent:"+this.ignoreFirstEvent,t),this.recordOnlyScreenViews){if("ScreenLoaded"===t.type||"OverlayLoaded"===t.type){if(this.ignoreFirstEvent)return this.logger.log(-1,"onEvent","ignore first event"),void(this.ignoreFirstEvent=!1);this.task.flow.push({screen:t.screen,widget:t.widget,type:t.type,state:t.state})}}else if(this.ignoredEvents.indexOf(t.type)<0){if(this.ignoreFirstEvent)return this.logger.log(-1,"onEvent","ignore first event"),void(this.ignoreFirstEvent=!1);this.task.flow.push({screen:t.screen,widget:t.widget,type:t.type,state:t.state})}},removeEvent(t){this.task.flow.splice(t,1)},setStrict(t){this.task.strict=t},onCancel(){this.emit("close",{})},onSave(){this.task.flow.sort(((t,e)=>t.time-e.time)),this.emit("save",this.task)},getValue(){return this.task},setValue(t){this.task=l.Z.clone(t)},cleanUp:function(){this.cleanUpTempListener()}},mounted(){}},b=p,m=s(43736),f=(0,m.Z)(b,a,i,!1,null,null,null),v=f.exports},15238:function(t,e,s){s.d(e,{Z:function(){return S}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcDashTaskPerfGram"},[t._m(0),s("div",{staticClass:"MatcDashTaskPerfActionCntr",attrs:{"data-dojo-attach-point":"actionCntr"}}),s("div",{staticClass:"MatcDashTaskPerfGramCntr",attrs:{"data-dojo-attach-point":"cntr"}},[s("span",{staticClass:"MatxAxisXLine MatcDashTaskPerfScatternVisible MatcDashTaskPerfGramDurationHidden",attrs:{"data-dojo-attach-point":"xLine"}}),s("span",{staticClass:"MatxAxisYLine MatcDashTaskPerfScatternVisible MatcDashTaskPerfGramDurationHidden",attrs:{"data-dojo-attach-point":"yLine"}}),s("div",{staticClass:"MatcDashTaskPerfGramCanvas",attrs:{"data-dojo-attach-point":"canvas"}}),s("span",{staticClass:"MatxAxisLabel xMaxLabel",attrs:{"data-dojo-attach-point":"xMaxLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcDashTaskPerfGramDropOffHidden yMaxLabel",attrs:{"data-dojo-attach-point":"yMaxLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcDashTaskPerfScatternVisible MatcDashTaskPerfGramDurationHidden xMiddleLabel",attrs:{"data-dojo-attach-point":"xMiddleLabel"}}),s("span",{staticClass:"MatxAxisLabel MatcDashTaskPerfScatternVisible MatcDashTaskPerfGramDurationHidden yMiddleLabel",attrs:{"data-dojo-attach-point":"yMiddleLabel"}}),s("span",{staticClass:"MatxAxisLabel minLabel",attrs:{"data-dojo-attach-point":"minLabel"}},[t._v("0")]),s("span",{staticClass:"MatxAxisLabel xLabel ",attrs:{"data-dojo-attach-point":"xLabel"}},[t._v("X")]),s("span",{staticClass:"MatxAxisLabel yLabel MatcDashTaskPerfGramDropOffHidden",attrs:{"data-dojo-attach-point":"yLabel"}},[t._v("Y")]),s("span",{staticClass:"MatxAxisLabel yLabelEast MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"yLabelEast"}},[t._v("Y")]),s("span",{staticClass:"MatxAxisLabel yMinLabelEast MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"yMinLabelEast"}},[t._v("0")]),s("span",{staticClass:"MatxAxisLabel yMaxLabelEast MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"yMaxLabelEast"}},[t._v("100")]),s("span",{staticClass:"MatxAxisLabel yMinLabel",attrs:{"data-dojo-attach-point":"yMinLabel"}}),s("span",{staticClass:"MatxAxisLabel bottom25Label MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"bottom25Label"}}),s("span",{staticClass:"MatxAxisLabel bottom75Label MatcDashTaskPerfDetailsVisible",attrs:{"data-dojo-attach-point":"bottom75Label"}}),s("span",{staticClass:"MatxAxisLabel MatxAxisLabelCntr",attrs:{"data-dojo-attach-point":"xAxisLabelCntr"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.hasTaskSelector,expression:"hasTaskSelector"}],staticClass:"MatcDashTaskPerfTaskCntr",attrs:{"data-dojo-attach-point":"taskCntr"}}),s("div",{staticClass:"MatcDashTaskPerfDropCntr",attrs:{"data-dojo-attach-point":"dropoffCntr"}},[s("CheckBox",{attrs:{label:"Show Dropoff"},on:{change:t.onChangeFunnelDropOff}})],1)]),s("div",{staticClass:"MatcDashTaskPerHintBar",attrs:{"data-dojo-attach-point":"hintCntr"}})])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcToolbarTabContainer"},[s("div",{staticClass:"MatcToolbarTabs",attrs:{"data-dojo-attach-point":"tabsCntr"}})])}],n=s(93921),l=s(24615),o=s(42477),r=s(93134),h=s(14285),c=s(41474),d=s(55887),u=s(14680),p=s(50597),b=s(21200),m=s(69912),f=s(77907),v=s(19519),M={name:"TaskPerfGram",mixins:[c.Z,p.Z,n.Z],data:function(){return{x_prefix:"",paddingFactor:1.1,tab:"scatter",tabs:{},dialog:!1,includeDropOff:!1,colors:["#56A9FC","#9933cc","#669900","#ff8a00","#cc0000","#000000","#8ad5f0","#d6adeb","#c5e26d"],bins:3,smoothLineFunction:m.jvg().curve(m.$0Z).x((t=>t.x-.5)).y((t=>t.y-.5)),straightLineFunction:m.jvg().x((t=>t.x-.5)).y((t=>t.y-.5)),canvasPos:{w:800,h:450},hasTaskSelector:!0}},components:{CheckBox:u.Z},methods:{postCreate(){this.log=new h.Z("TaskPerfGram"),this.init(),this._scatterPoints={}},init(){this.db=new d.Z,this.addTab("scatter","MatcToolbarTabActive"),this.addTab("details",""),this.addTab("funnelDurartion",""),this.addTab("funnelInteraction",""),this._scatterPoints={}},addTab(t,e){var s=this.db.a(e,this.getNLS("dash.perf.tab."+t)).build(this.tabsCntr);this.own((0,l.Z)(s,"mousedown",o.Z.hitch(this,"setTab",t))),this.tabs[t]=s},setTab(t){if(this.tab!=t){for(var e in this.lastTab=this.tab,this.tab=t,this.tabs)r.Z.remove(this.tabs[e],"MatcToolbarTabActive");this.tabs[t]&&r.Z.add(this.tabs[t],"MatcToolbarTabActive"),this.render()}},setModel(t){this.model=t},setValue(t,e,s,a){this.df=t,this.task=e,this.annotations=s,this.tasks=a,this.renderTasks(a),this.selectTask(e),this.render()},renderTasks(t){this.log.log(-1,"renderTasks","enter"),this.taskDivs={},this.taskCircles={},this.selectedTasks={},this.taskColors={};for(let e=0;e<t.length;e++){const s=t[e];if(s.flow.length>=2){this.selectedTasks[s.id]=!1,this.taskColors[s.id]=this.colors[e%this.colors.length];const a=this.db.div().build(this.taskCntr),i=this.db.span("").build(a);this.db.label("",t[e].name).build(a),this.taskCircles[s.id]=i,this.taskDivs[s.id]=a,this.own((0,l.Z)(a,"click",o.Z.hitch(this,"clickTask",s,e)))}}},clickTask(t){this.selectTask(t),this.render(!0)},selectTask(t){this.selectedTasks[t.id]=!this.selectedTasks[t.id];for(let e in this.selectedTasks){const t=this.taskCircles[e],s=this.taskDivs[e];s&&t&&(this.selectedTasks[e]?(r.Z.add(s,"MatcDashTaskPerfTaskSelected"),t.style.background=this.taskColors[e]):(r.Z.remove(s,"MatcDashTaskPerfTaskSelected"),t.style.background=""))}},render(t){this.log.log(-1,"render","enter > "+t),this.cleanUpTempListener(),this.task.flow&&this.task.flow.length>=2?!t&&this["clean_"+this.lastTab]?this["clean_"+this.lastTab](o.Z.hitch(this,"renderTab",t)):this.renderTab(t):(r.Z.add(this.tabsCntr,"hidden"),r.Z.add(this.cntr,"hidden"),this.db.h2("",this.getNLS("dash.perf.no-flow-title")).build(this.domNode),this.db.div("MatcMarginTop",this.getNLS("dash.perf.no-flow-msg"),!0).build(this.domNode))},renderTab(t){"dropoff"===this.tab||"funnelDurartion"===this.tab||"funnelInteraction"===this.tab?r.Z.add(this.domNode,"MatcDashTaskPerfGramHideTasks"):r.Z.remove(this.domNode,"MatcDashTaskPerfGramHideTasks"),"funnelDurartion"===this.tab||"funnelInteraction"===this.tab?r.Z.remove(this.domNode,"MatcDashTaskPerfGramHideDropoff"):r.Z.add(this.domNode,"MatcDashTaskPerfGramHideDropoff"),this["render_"+this.tab]?this["render_"+this.tab](this.df,this.task,this.annotations,this.tasks,t):this.log.error("render","No render for "+this.tab)},onChangeFunnelDropOff(t){this.log.log(-1,"onChangeFunnelDropOff","enter > :",this.tab),this.includeDropOff=t,"funnelDurartion"===this.tab&&(this.clean_funnelDurartion(),this.render_funnelDurartion(this.df,this.task,!0)),"funnelInteraction"===this.tab&&(this.clean_funnelInteraction(),this.render_funnelInteraction(this.df,this.task,!0))},render_funnelInteraction(t,e){this.log.log(-1,"render_funnelInteractions","enter > :",this.includeDropOff),r.Z.add(this.domNode,"MatcDashTaskPerfGramFunnel"),this.xLabel.innerHTML="",this.yLabel.innerHTML="",this.yLabelEast.innerHTML="",this.bottom25Label.innerHTML="",this.bottom75Label.innerHTML="",this.xMaxLabel.innerHTML="",this.yMaxLabel.innerHTML="",this.yMaxLabel.innerHTML="",this.yMinLabelEast.innerHTML="",this.minLabel.innerHTML="",this.yMinLabel.innerHTML="0";const s=60,a=e.flow,i=(this.canvasPos.w-2*s)/(a.length-1),n=this.canvasPos.h-20,o=new b.Z,h=o.getFunnelInteraction(t,e,this.includeDropOff),c=o.getFunnelMax(h)+1;this._render_funnel_steps(h,c,a,i,s,n),this._render_funnel_lines(h,c,i,s,n,(t=>Math.round(t))),this.yMaxLabel.innerHTML=c,this.tempOwn((0,l.Z)(this.cntr,"click",(()=>this.reset_funnel_selection())))},clean_funnelInteraction(t){this.log.log(-1,"clean_funnelInteractions","enter > :"),r.Z.remove(this.domNode,"MatcDashTaskPerfGramFunnel"),this._stepDivs&&(this._stepDivs.forEach((t=>{t.parentNode.removeChild(t)})),delete this._stepDivs),this.funnelSVG&&(this.canvas.innerHTML="",delete this.funnelSVG),this.xAxisLabelCntr.innerHTML="",this.yMinLabel.innerHTML="",t&&t()},render_funnelDurartion(t,e){this.log.log(-1,"render_funnelDurartion","enter > :"),r.Z.add(this.domNode,"MatcDashTaskPerfGramFunnel"),this.xLabel.innerHTML="",this.yLabel.innerHTML="",this.yLabelEast.innerHTML="",this.bottom25Label.innerHTML="",this.bottom75Label.innerHTML="",this.xMaxLabel.innerHTML="",this.yMaxLabel.innerHTML="",this.yMaxLabel.innerHTML="",this.yMinLabelEast.innerHTML="",this.minLabel.innerHTML="",this.yMinLabel.innerHTML="0";const s=60,a=e.flow,i=(this.canvasPos.w-2*s)/(a.length-1),n=this.canvasPos.h-20,o=new b.Z,h=o.getFunnelDuration(t,e,this.includeDropOff),c=o.getFunnelMax(h)+1e3;this._render_funnel_steps(h,c,a,i,s,n),this._render_funnel_lines(h,c,i,s,n,(t=>Math.round(t/100)/10+" s")),this.yMaxLabel.innerHTML=Math.ceil(c/1e3)+" s",this.tempOwn((0,l.Z)(this.cntr,"click",(()=>this.reset_funnel_selection())))},reset_funnel_selection(){this.selectFunnelPoint(!1),this.setHint()},_render_funnel_lines(t,e,s,a,i,n){const l=this.db.div("MatcDashTaskPerfGramFunnelSVG MatcDashTaskPerfGramFunnelSVGHidden").build(this.canvas);this.funnelSVG=m.Ys(l).append("svg").attr("width",this.canvasPos.w).attr("height",this.canvasPos.h),this.lineSVGs={},this.lineColor={},this.linePoints={};for(let o in t){let l=t[o];this._render_funnel_session_line(o,l,e,s,i,a,n)}setTimeout((()=>{r.Z.remove(l,"MatcDashTaskPerfGramFunnelSVGHidden")}),200)},_render_funnel_session_line(t,e,s,a,i,n,r){const h=Math.round(a/4);let c=[],d=this.colors[0];this.linePoints[t]=[],e.forEach(((u,p)=>{d=!0===u.dropoff?"red":this.colors[0];let b={x:n+a*p,y:i-u.value/s*i},m=this.db.div("MatcDashTaskPerfGramFunnelStepPoint").left(b.x).top(b.y).build(this.canvas);this.db.div("MatcDashTaskPerfGramFunnelStepPointLabel",r(u.value)).build(m),m.style.background=d,this.tempOwn((0,l.Z)(m,"click",o.Z.hitch(this,"selectFunnelPoint",t))),this.linePoints[t].push(m),p>0&&c.push({x:b.x-h,y:b.y}),c.push(b),p<e.length-1&&c.push({x:b.x+h,y:b.y})}));let u=this.funnelSVG.append("path").attr("d",this.smoothLineFunction(c)).attr("stroke",d).attr("stroke-width",1).attr("fill","none").style("opacity",.5);this.lineSVGs[t]=u,this.lineColor[t]=d},_render_funnel_steps(t,e,s,a,i,n){this._stepDivs=[],s.length>1&&s.forEach(((l,o)=>{const h=this.getStepData(t,o),c=new f.Z(h),d=Math.ceil(c.max("value")),u=Math.ceil(c.min("value")),p=Math.ceil(c.mean("value")),b=Math.ceil(c.std("value")),m=i+a*o,v=this.db.div("MatcDashTaskPerfGramFunnelStep MatcDashTaskPerfGramFunnelStepSmall").left(m).build(this.canvas);this.render_funnel_box_plot(v,-11,20,d,u,p,b,e,this.colors[0],n),this._stepDivs.push(v);const M=s.length<7?this.getNiceEventLabel(l,o,!1):"Step "+(o+1);this.db.div("MatcDashTaskPerfGramFunnelStepLabel",M).left(i+a*o).build(this.xAxisLabelCntr),setTimeout((()=>{r.Z.remove(v,"MatcDashTaskPerfGramFunnelStepSmall")}),Math.min(300,50*o))}))},render_funnel_box_plot(t,e,s,a,i,n,l,o,r,h){const c=(a-i)/o*h,d=this.db.div("MatcDashTaskPerfGramBoxPlotCntr").top(h-a/o*h).h(c).w(s).left(e).build(t),u=this.db.div("MatcDashTaskPerfGramBoxPlot").build(d);u.style.bottom=100*Math.max(0,(n-l-i)/(a-i))+"%",u.style.height=2*l/(a-i)*100+"%",u.style.background=r;const p=this.db.div("MatcDashTaskPerfGramBoxPlotMean").build(d);p.style.bottom=(n-i)/(a-i)*100+"%"},getStepData(t,e){const s=[];for(let a in t){const i=t[a];void 0!==i[e]&&s.push(i[e])}return s},selectFunnelPoint(t,e){this.log.log(-1,"selectFunnelPoint","enter > :",t),this.stopEvent(e),this.showSessionReplayHint(t);for(let s in this.lineSVGs){const e=this.lineSVGs[s],a=s===t?this.colors[1]:this.lineColor[s];e&&e.attr("stroke",a),this.linePoints[s]&&this.linePoints[s].forEach((t=>{t.style.background=a}))}},clean_funnelDurartion(t){this.log.log(-1,"clean_funnelDurartion","enter > :"),r.Z.remove(this.domNode,"MatcDashTaskPerfGramFunnel"),this._stepDivs&&(this._stepDivs.forEach((t=>{t.parentNode.removeChild(t)})),delete this._stepDivs),this.funnelSVG&&(this.canvas.innerHTML="",delete this.funnelSVG),this.xAxisLabelCntr.innerHTML="",this.yMinLabel.innerHTML="",t&&t()},render_details(t,e,s,a){this.log.log(-1,"render_duration","enter > changeTask:"),r.Z.add(this.domNode,"MatcDashTaskPerfGramDetails"),this.xLabel.innerHTML="",this.yLabel.innerHTML="",this.yLabelEast.innerHTML="",this.bottom25Label.innerHTML=this.getNLS("dash.perf.details.bottom25Label"),this.bottom75Label.innerHTML=this.getNLS("dash.perf.details.bottom75Label"),this.xMaxLabel.innerHTML="",this.yMinLabel.innerHTML="",this.minLabel.innerHTML="";var i=new b.Z,n=i.getTaskPerformance(t,a),l=1,o=1,h=0;for(let r in this.selectedTasks)if(this.selectedTasks[r]){let t=n.select("task","==",r);l=Math.max(l,Math.ceil(t.max("duration")*this.paddingFactor)),o=Math.max(o,Math.ceil(t.max("interactions")*this.paddingFactor)),h++}this.yMaxLabel.innerHTML=o,this.yMaxLabelEast.innerHTML=Math.ceil(l/1e3)+" s";var c=0,d=2,u=2*h-1;for(let r in this.selectedTasks)if(this.selectedTasks[r]){let t=n.select("task","==",r),e=Math.ceil(t.max("interactions")),s=Math.ceil(t.min("interactions")),a=Math.ceil(t.mean("interactions")),i=Math.ceil(t.std("interactions")),h=25-d*u/2+2*c*d+"%";this.createBoxPlot(r,"i",c,h,d,e,s,a,i,o,this.taskColors[r]),e=Math.ceil(t.max("duration")),s=Math.ceil(t.min("duration")),a=Math.ceil(t.mean("duration")),i=Math.ceil(t.std("duration")),h=75-d*u/2+2*c*d+"%",this.createBoxPlot(r,"d",c,h,d,e,s,a,i,l,this.taskColors[r]),c++}else if(this._bars){if(this._bars[r+"i"]){let t=this._bars[r+"i"];t.parentNode.removeChild(t),delete this._bars[r+"i"]}if(this._bars[r+"d"]){let t=this._bars[r+"d"];t.parentNode.removeChild(t),delete this._bars[r+"d"]}}},createBoxPlot(t,e,s,a,i,n,l,r,h,c,d,u="%"){this._bars||(this._bars={});var p=(n-l)/c*100+"%",b=Math.min(60*s,500);if(this._bars[t+e]){let s=this._bars[t+e];s.style.left=a,setTimeout(o.Z.hitch(this,"animateBoxplot",s,p),b)}else{let s=this.db.div("MatcDashTaskPerfGramBoxPlotCntr").build(this.canvas);s.style.bottom=l/c*100+"%",s.style.left=a,s.style.height="0px",s.style.width=i+u,this.db.div("MatcDashTaskPerfGramBoxPlotLine").build(s);var m=this.db.div("MatcDashTaskPerfGramBoxPlot").build(s);m.style.bottom=100*Math.max(0,(r-h-l)/(n-l))+"%",m.style.height=2*h/(n-l)*100+"%",m.style.background=d;var f=this.db.div("MatcDashTaskPerfGramBoxPlotMean").build(s);f.style.bottom=(r-l)/(n-l)*100+"%",setTimeout(o.Z.hitch(this,"animateBoxplot",s,p),b),this._bars[t+e]=s}},animateBoxplot(t,e){t.style.height=e},clean_details(t){if(this.log.log(-1,"clean_duration","enter"),r.Z.remove(this.domNode,"MatcDashTaskPerfGramDetails"),this.setHint(),this._bars)for(var e in this._bars){var s=this._bars[e];s.style.height="0%",s.style.bottom="0%"}setTimeout(o.Z.hitch(this,"removeBoxplots"),200),t&&setTimeout(t,200)},removeBoxplots:function(){if(this._bars)for(var t in this._bars){var e=this._bars[t];this.canvas.removeChild(e)}delete this._bars},render_scatter(t,e,s,a,i){this.log.log(-1,"render_scatter","enter > changeTask:"+i);var n=new d.Z;delete this._selectedScatterPoint,this.setHint(n.span("",this.getNLS("dash.perf.hint.scatter")).build()),r.Z.add(this.domNode,"MatcDashTaskPerfGramScatter"),this.xLabel.innerHTML=this.getNLS("dash.perf.scatter.xLabel"),this.yLabel.innerHTML=this.getNLS("dash.perf.scatter.yLabel"),this.minLabel.innerHTML="0 s",this.yMinLabel.innerHTML="0";var h=new b.Z,c=h.getTaskPerformance(t,a);let u=1,p=1,m=0,f=0,v=0;for(let l in this.selectedTasks)if(this.selectedTasks[l]){let t=c.select("task","==",l);u=Math.max(u,Math.ceil(t.max("duration")*this.paddingFactor)),p=Math.max(p,Math.ceil(t.max("interactions")*this.paddingFactor))}this.xMaxLabel.innerHTML=Math.ceil(u/1e3)+" s",this.yMaxLabel.innerHTML=Math.ceil(p);for(let r in this.selectedTasks){let t=c.select("task","==",r),e=t.data;if(e.sort((function(t,e){return e.interactions-t.interactions})),this.selectedTasks[r]){m=t.mean("duration"),f=t.mean("interactions");for(let t=0;t<e.length;t++){let s=e[t],a=s.session+" "+r,i=Math.min(10*t,300);if(v=Math.max(v,i),this._scatterPoints[a]){let e=this._scatterPoints[a];this.tempOwn((0,l.Z)(e,"click",o.Z.hitch(this,"selectPoint",e,s,t))),setTimeout(o.Z.hitch(this,"animateScatterPoint",e,s,u,p),i)}else{let e=n.span("MatxScatterPoint").build(this.canvas);e.style.bottom="-5%",e.style.left=s.duration/u*100+"%",e.style.background=this.taskColors[r],this._scatterPoints[a]=e,this.tempOwn((0,l.Z)(e,"click",o.Z.hitch(this,"selectPoint",e,s,t))),setTimeout(o.Z.hitch(this,"animateScatterPoint",e,s,u,p),i)}}}else for(let s=0;s<e.length;s++){let t=e[s],a=t.session+" "+r;if(this._scatterPoints[a]){let t=this._scatterPoints[a];t.style.opacity=0,setTimeout(o.Z.hitch(this,"fadeOutPoint",t),300),delete this._scatterPoints[a]}}}this.max_interactions=p,this.max_duration=u,setTimeout(o.Z.hitch(this,"setMiddle",f,p,m,u),200)},fadeOutPoint(t){t.parentNode&&t.parentNode.removeChild(t)},clean_scatter(t){if(this.log.log(-1,"clean_scatter","enter"),r.Z.remove(this.domNode,"MatcDashTaskPerfGramScatter"),this.setHint(),this._scatterPoints)for(var e in this._scatterPoints){var s=this._scatterPoints[e];s.style.bottom="-5%"}setTimeout(o.Z.hitch(this,"removePoints"),200),t&&setTimeout(t,200),this.yMinLabel.innerHTML="",this.minLabel.innerHTML=""},removePoints(){if(this._scatterPoints)for(var t in this._scatterPoints){var e=this._scatterPoints[t];e.parentNode&&e.parentNode.removeChild(e)}delete this._scatterPoints,this._scatterPoints={}},selectPoint(t,e,s,a){this.stopEvent(a),this.setXMiddle(e.duration,this.max_duration),this.setYMiddle(e.interactions,this.max_interactions),r.Z.add(this.cntr,"MatcDashTaskPerfGramCntrHover"),this._selectedScatterPoint=t,this.showSessionReplayHint(e.session)},showSessionReplayHint(t){if(this.model){let e="#/apps/"+this.model.id+"/replay/"+t+".html";"public"==this.mode&&(e="#/examples/"+this.model.id+"/replay/"+t+".html");const s=this.db.span("",this.getNLS("dash.perf.hint.session-msg")).build(),a=this.db.a("",this.getNLS("dash.perf.hint.session-play")).build(s);a.href=e,a.target="_matcSessionReplay"+t,this.setHint(s)}},render_dropoff(t,e,s){if(this.log.log(-1,"render_dropoff","enter > "+e.flow.length),r.Z.add(this.domNode,"MatcDashTaskPerfGramDropOff"),this.xLabel.innerHTML=this.getNLS("dash.perf.dropoff.xLabel"),this.xMaxLabel.innerHTML="100%",this.minLabel.innerHTML="",this._bars={},this._barLabels={},!this.funnel){var a=new b.Z;this.funnel=a.getFunnelSummary(t,e,s)}for(var i=0;i<this.funnel.length;i++){var n=this.funnel[i],l=n.p;if(n.event){var h=this.getNiceEventLabel(n.event,i),c=40*(i-1)+10+"px",d=this.db.div("MatcDashTaskPerfGramBar").build(this.canvas);d.style.top=c,d.style.left="0px",d.style.height="20px",d.style.width="0%",d.style.background=this.greenToRed(l),d.innerHTML=Math.round(100*l)+"%";var u=this.db.span("MatxAxisLabel MatcDashTaskPerfGramBarLabel MatcDashTaskPerfGramScatterHidden MatcDashTaskPerfGramBarLabelHidden",h).build(this.cntr);u.style.top=c;var p=Math.min(60*i,500);setTimeout(o.Z.hitch(this,"animateBar",d,u,Math.max(1,Math.min(99,100*l))+"%"),p),this._bars[i]=d,this._barLabels[i]=u}}},animateBar(t,e,s){t.style.width=s,r.Z.remove(e,"MatcDashTaskPerfGramBarLabelHidden")},clean_dropoff(t){if(this.log.log(-1,"clean_dropoff","enter"),r.Z.remove(this.domNode,"MatcDashTaskPerfGramDropOff"),this._barLabels)for(let e in this._barLabels){let t=this._barLabels[e];t.parentNode.removeChild(t)}if(delete this._barLabels,this._bars)for(let e in this._bars){let t=this._bars[e];t.style.width="0%"}setTimeout(o.Z.hitch(this,"removeBars"),200),this.setHint(),t&&setTimeout(t,200)},removeBars(){if(this._bars)for(var t in this._bars){var e=this._bars[t];this.canvas.removeChild(e)}delete this._bars},showSessionReplay(t,e,s){this.stopEvent(s),this.dialog&&this.dialog.close(),location.href=t},hoverPoint(t){this._selectedScatterPoint==t&&r.Z.add(this.cntr,"MatcDashTaskPerfGramCntrHover")},setHint(t){this.hintCntr.innerHTML="",t&&(this.hintCntr.appendChild((0,v.Xl)("PlayVideo")),this.hintCntr.appendChild(t))},clearPoint(){r.Z.remove(this.cntr,"MatcDashTaskPerfGramCntrHover")},setMiddle(t,e,s,a){this.setXMiddle(s,a),this.setYMiddle(t,e),r.Z.remove(this.cntr,"MatcDashTaskPerfGramCntrHover")},setYMiddle(t,e){this.yMiddleLabel.innerHTML=Math.ceil(t),this.yMiddleLabel.style.bottom=t/e*100+"%",this.yLine.style.bottom=t/e*100+"%"},setXMiddle(t,e){this.xMiddleLabel.innerHTML=Math.ceil(t/1e3)+" s",this.xMiddleLabel.style.left=t/e*100+"%",this.xLine.style.left=t/e*100+"%"},animateScatterPoint(t,e,s,a){t.style.bottom=e.interactions/a*100+"%",t.style.left=e.duration/s*100+"%"},getNiceEventLabel(t,e,s=!0){if(this.model){const e=this.getScreenName(t.screen,!0),i=this.getWidgetName(t.widget,!0);var a=[];if(t.widget){const n=s?" @ "+e:"";if("WidgetGesture"!=t.type||!t.gesture)return!t.state||"WidgetClick"!=t.type&&"WidgetChange"!=t.type?this.getEventLabel(t.type)+" -  "+i+n:this.getEventStateLabel(t.state)+" -  "+i+n;{let e=t.gesture;a=[this.getGestureLabel(e.type),i]}}else if("ScreenGesture"==t.type&&t.gesture){let s=t.gesture;a=["Screen "+this.getGestureLabel(s.type),e]}else a=[this.getEventLabel(t.type),e];return a[0]+" - "+a[1]}return this.getNLS("dash.perf.dropoff.step")+e}},mounted(){}},g=M,L=s(43736),k=(0,L.Z)(g,a,i,!1,null,null,null),S=k.exports},11792:function(t,e,s){s.d(e,{Z:function(){return T}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"MatcTestSettings MatcDashTable"},[s("div",{attrs:{"data-dojo-attach-point":"tableCntr"}},[t.hasTests?s("div",[s("table",{staticClass:"vommondTable table is-hoverable"},[t._m(0),s("tbody",t._l(t.testSettings.tasks,(function(e,a){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.name))]),s("td",[t._v(t._s(t.shorten(e.description)))]),s("td",[e.flow&&e.flow.length>0?[s("div",{staticClass:"StepCntr"},t._l(t.getTaskSteps(e),(function(e,a){return s("div",{key:a,class:"Step "+e.type},[a>0?s("span",{staticClass:"mdi mdi-arrow-right"}):t._e(),s("div",{staticClass:"StepDetails"},[t._v(t._s(t.shorten(e.label,20))+" ")])])})),0)]:s("span",{staticClass:"MatcHint"},[t._v("No steps ")])],2),s("td",{staticClass:" action"},[s("div",{staticStyle:{width:"100px",display:"flex","justify-content":"flex-end"}},[s("a",{staticClass:"MatcButton MatcButtonXXS MatcButtonSecondary",on:{click:function(s){return t.onEditTask(e,a,s)}}},[s("QIcon",{attrs:{icon:"EditSquare"}})],1),s("a",{staticClass:"MatcButton MatcButtonXXS MatcButtonDanger MatcButtonSecondary",on:{click:function(s){return t.onDelete(e,a,s)}}},[s("QIcon",{attrs:{icon:"DeleteTrash"}})],1)])])])})),0)]),s("div",{staticClass:"form-group mb-32"},[s("CheckBox",{attrs:{value:t.test.showTaskInTest,label:t.getNLS("testSettingsShowTaskInTest")},on:{change:t.onShowTaskChange}})],1),t.test.showTaskInTest?s("div",{staticClass:"form-group"},[s("CheckBox",{attrs:{value:t.test.showSuccessInTest,label:t.getNLS("testSettingsShowSuccessInTest")},on:{change:t.onShowSuccessInTest}})],1):t._e()]):s("p",{staticClass:"mb-32"},[t._v(" "+t._s(t.getNLS("testSettingsTaskAddHint"))+" ")])]),s("a",{staticClass:"MatcButton MatcButtonXXS",attrs:{"data-nls":"testSettingsAddTask"},on:{click:t.showCreateDialog}},[t._v("Add task")])])},i=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticStyle:{width:"20%"}},[t._v("Name")]),s("td",{staticStyle:{width:"30%"}},[t._v("Description")]),s("td",{staticStyle:{width:"35%"}},[t._v("Steps")]),s("td",{staticClass:"action",staticStyle:{width:"15%"}},[t._v("Action")])])])}],n=s(93921),l=s(93134),o=s(42477),r=s(24615),h=s(4623),c=s(14285),d=s(51804),u=s(55887),p=s(14680),b=s(50597),m=s(84157),f=s(63403),v=s(27437),M=s(13929),g={name:"TestSettings",props:["test","app","annotation","events","hash"],mixins:[b.Z,m.Z,n.Z],data:function(){return{testSettings:null,appID:"",userID:""}},components:{CheckBox:p.Z,QIcon:f.Z},computed:{pub(){return this.$route.meta&&this.$route.meta.isPublic},hasTests(){return this.testSettings&&this.testSettings.tasks&&this.testSettings.tasks.length>0}},methods:{shorten(t,e=70){return t&&t.length>e?t.substring(0,e)+"...":t},getTaskSteps(t){let e=[];return t.flow.length>0&&e.push(this.createStep(t.flow[0])),t.flow.length>2&&e.push({type:"",label:"..."}),t.flow.length>1&&e.push(this.createStep(t.flow[t.flow.length-1])),e},createStep(t){return{label:t.widget?this.getWidgetName(t.widget):this.getScreenName(t.screen),type:t.widget?"widget":"screen"}},getScreenName(t){return this.app.screens[t]&&this.app.screens[t].name?this.app.screens[t].name:t},getWidgetName(t){return this.app.widgets[t]&&this.app.widgets[t].name?this.app.widgets[t].name:t},postCreate(){this.logger=new c.Z("TestSettings"),this.logger.log(4,"postCreate","enter > "+this.appID+" > "+this.pub),this.db=new u.Z,this.test&&this.setValue(this.test)},setValue(t){this.testSettings=t},render(t){this.cleanUpTempListener(),this.renderTaskTable(t)},onShowTaskChange(t){this.test.showTaskInTest=t,this.save()},onShowSuccessInTest(t){this.test.showSuccessInTest=t,this.save()},showCreateDialog(){var t=new d.Z,e=document.createElement("div");l.Z.add(e,"MatchTaskRecorderDialog");var s=this.$new(M.Z,{model:this.app,hash:this.hash});s.setValue({name:"Task "+(this.test.tasks.length+1),description:"",flow:[],strict:!1}),s.placeAt(e),t.popup(e,this.addBTN),t.own((0,r.Z)(t,"close",(function(){s.destroy()}))),t.own((0,r.Z)(s,"close",(function(){t.close()}))),t.own((0,r.Z)(s,"save",o.Z.hitch(this,"createNewTask",s,t)))},async createNewTask(t,e){let s=t.getValue();e.close(),this.test.tasks||(this.test.tasks=[]),this.test.tasks.push({name:s.name,description:s.description,id:"t"+Date.now(),strict:s.strict,flow:s.flow}),this.save()},onEditTask(t,e,s){var a=new d.Z,i=document.createElement("div");l.Z.add(i,"MatchTaskRecorderDialog");var n=this.$new(M.Z,{model:this.app,hash:this.hash,ignoreFirstEvent:!0});n.setValue(t),n.placeAt(i),a.popup(i,s.target),a.own((0,r.Z)(a,"close",(function(){n.destroy()}))),a.own((0,r.Z)(n,"close",(function(){a.close()}))),a.own((0,r.Z)(n,"save",o.Z.hitch(this,"updateTask",n,a)))},updateTask(t,e){let s=t.getValue(),a=this.test.tasks.find((t=>t.id===s.id));a?(a.name=s.name,a.strict=s.strict,a.flow=s.flow,a.description=s.description,this.save()):console.error("AnalyticTaskList.saveFlow() > Cannot find task",s),e.close()},onDelete(t,e,s){var a=t.name?t.name:t.label,i=this.db.div("MatcDeleteDialog").build();this.db.h3("title is-4",this.getNLS("testSettingTaskDeleteTitle")).build(i),this.db.p("MatcMarginBottomXL",this.getNLS("testSettingTaskDelete1")+a+this.getNLS("testSettingTaskDelete2")).build(i);var n=this.db.div("MatcButtonBar").build(i),l=this.db.a("MatcButton MatcButtonDanger",this.getNLS("btn.delete")).build(n),c=this.db.a("MatcLinkButton",this.getNLS("btn.cancel")).build(n),u=new d.Z;u.own((0,r.Z)(l,h.Z.press,o.Z.hitch(this,"removeTask",e,u))),u.own((0,r.Z)(c,h.Z.press,o.Z.hitch(u,"close"))),u.popup(i,s.target)},removeTask(t,e){this.test.tasks.splice(t,1),e.close(),this.save()},async save(){if(this.pub)this.showSuccess(this.getNLS("testSettingsRegister"));else{let t=await v.Z.getModelService().saveTestSettings(this.app.id,this.test);"ok"===t.status&&(this.showSuccess("Saved.."),this.$emit("change",this.test))}},_onEditFlow(t,e,s){var a=this.test.tasks;for(let n=0;n<a.length;n++){var i=a[n];i.id==t.id&&this.onFlow(s,i,n)}},onFlow(t,e){this.showTaskFlow(t,e,this.app)},cleanUp(){this.cleanUpTempListener()}},watch:{test(t){console.debug("TestSetting.watch() > test",t),this.test=t,this.setValue(t)}},mounted(){}},L=g,k=s(43736),S=(0,k.Z)(L,a,i,!1,null,null,null),T=S.exports}}]);
//# sourceMappingURL=982.d4763ec4.js.map